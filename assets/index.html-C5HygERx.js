import{_ as a,c as n,b as t,o as p}from"./app-IQA0dJD3.js";const m={};function l(e,s){return p(),n("div",null,s[0]||(s[0]=[t('<p>视图变换</p><p>Zhiqi Li <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mn>1</mn><mo separator="true">,</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">{}^{1,2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> , Zhiding Yu <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">{}^{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> , David Austin <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">{}^{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> , Mingsheng Fang <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">{}^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> , Shiyi Lan <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">{}^{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> , Jan Kautz <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">{}^{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> , Jose M. Alvarez <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">{}^{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">{}^{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> NVIDIA <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">{}^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> 南京大学</p><h6 id="摘要" tabindex="-1"><a class="header-anchor" href="#摘要"><span>摘要</span></a></h6><p>本技术报告总结了在CVPR 2023“端到端自动驾驶研讨会”和“以视觉为中心的自动驾驶研讨会”联合举办的3D占据预测挑战赛中的获胜解决方案。我们提出的FB-OCC方案基于FB-BEV，这是一种利用前向后向投影的先进基于相机的鸟瞰图感知设计。在FB-BEV基础上，我们进一步研究了针对3D占据预测任务的新设计和优化，包括联合深度-语义预训练、联合体素-BEV表示、模型规模化以及有效的后处理策略。这些设计和优化在nuScenes数据集上实现了54.19%的最优mIoU分数，在挑战赛道中排名第一。代码和模型将在以下地址发布：https://github.com/NVlabs/FB-BEV。</p><h2 id="_1-引言" tabindex="-1"><a class="header-anchor" href="#_1-引言"><span>1 引言</span></a></h2><p>3D占据预测是指预测3D体素空间中每个体素的占据状态和语义类别，是自动驾驶车辆（AV）感知中的重要任务。通过为规划栈提供丰富信息，预测3D占据对开发安全、稳健的自动驾驶系统至关重要[1]。挑战赛道要求参赛者仅使用相机输入开发占据预测算法，同时允许使用开源数据集和模型，这为探索数据驱动算法和大规模模型提供了便利。该挑战通过在实际场景中为最新3D占据预测算法提供试验场，具有重要影响。</p><p>在挑战背景下，除了模型结构设计的努力外，我们强调模型规模和预训练技术的重要性。这一关注源于以下动机：首先，已有多种鸟瞰图（BEV）感知解决方案达到顶尖性能[2,3,4]，这些方案可通过修改适配3D占据预测任务。然而，关于大规模模型和预训练对占据预测任务影响的研究仍有限。如本工作所述，大规模模型和预训练技术的使用是我们成功的关键因素。</p><h2 id="_2-方法" tabindex="-1"><a class="header-anchor" href="#_2-方法"><span>2 方法</span></a></h2><p>本节将详细介绍我们的解决方案，涵盖以下方面：第2.1节阐述模型设计；第2.2节讨论预训练和规模化工作；第2.3节概述后处理策略。</p><h3 id="模型设计" tabindex="-1"><a class="header-anchor" href="#模型设计"><span>模型设计</span></a></h3><p>首先介绍FB-BEV。视图变换是基于相机的3D感知的核心模块，现有方法主要基于两种视图变换策略：前向投影（以Lift-Splat-Shoot[5]为代表）和后向投影（以BEVFormer[2]为代表）。FB-BEV采用统一设计，结合两种方法优势，克服各自局限。在FB-OCC中，我们使用前向投影生成初始3D体素表示，再将其压缩为扁平化的BEV特征图。BEV特征图作为查询在BEV空间中关注图像编码器特征，获取密集几何信息。3D体素表示与优化后的BEV表示的融合特征随后输入任务头。</p><p>在前向投影模块中，我们遵循Lift-Splat-Shoot（LSS）[5]原则，考虑每个像素深度估计的不确定性，将图像特征投影到3D空间。不同于LSS建模BEV特征，我们直接建模3D体素表示以捕获更详细的3D空间信息。此外，采用BEVDepth[4]利用点云生成精确深度真值，监督模型深度预测以提高准确性。LSS生成的3D表示较稀疏，为此我们引入后向投影方法优化稀疏3D表示。出于计算负担考虑，此阶段使用BEV表示而非3D体素表示。后向投影方法受BEVFormer[2]启发，但不同于其使用随机初始化参数作为BEV查询，我们将3D体素表示压缩为BEV表示，融入更强语义先验。此外，后向投影在投影阶段利用深度分布，实现更精确的投影关系建模。</p><p>获取3D体素表示和优化的BEV表示后，通过扩展BEV特征结合二者，得到最终3D体素表示。体素编码器和占据预测头如图1和图2所示。</p><p>训练模型时，我们使用受M2BEV[6]启发的距离感知Focal损失函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>f</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{fl}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 、Dice损失 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>d</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{dl}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 、MonoScene[7]的亲和力损失 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>L</mi><mrow><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi></mrow><mrow><mi>g</mi><mi>e</mi><mi>o</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">L_{scal}^{geo}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0836em;vertical-align:-0.3013em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em;"><span style="top:-2.3987em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">sc</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">eo</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>L</mi><mrow><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi></mrow><mrow><mi>s</mi><mi>e</mi><mi>r</mi><mi>m</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">L_{scal}^{serm}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9664em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">sc</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">ser</span><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span></span></span></span> 、OpenOccupancy[8]的lovasz-softmax损失 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>l</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{ls}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 。此外还需深度监督损失 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">L_{d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和2D语义损失 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">L_{s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ，详见下节。</p><h3 id="规模化与预训练" tabindex="-1"><a class="header-anchor" href="#规模化与预训练"><span>规模化与预训练</span></a></h3><p>增加模型规模通常是提升精度的便捷方法。然而在纯视觉3D感知领域，研究者发现使用更强大的2D主干易导致过拟合[3]。例如在nuScenes 3D目标检测任务中，最大主干如VIT-L[9]（约3亿参数）和常用主干如ConvNext-B[10]、VoVNet-99[11]（约1亿参数）常遇此问题。为解决这一挑战，我们探索在多相机3D感知任务中使用10亿参数主干InternImage-H[12]。但直接应用此主干会因训练样本有限（nuScenes仅4万样本[13]）导致严重过拟合。为此，我们利用比赛允许使用额外公开数据的优势，扩充数据资源以更有效训练大规模模型。基于开源的InternImage-H检查点，我们在Object365数据集[14]（含200万图像的2D目标检测数据集）上进行预训练，增强模型语义感知能力。但将预训练模型应用于下游3D感知任务仍存在领域差距，因此我们进一步针对3D感知任务进行针对性预训练。有效预训练方法是通过深度估计任务增强模型几何感知能力，故在nuScenes数据集上以深度估计为重点进行大规模预训练。需注意深度预训练缺乏语义级监督，为避免模型过度偏向深度信息而丢失语义先验（尤其是大规模模型易过拟合），我们在深度预测任务中同时预测2D语义分割标签，如图3所示。</p><p>nuScenes未提供2D图像语义分割标签，为此采用流行的Segment Anything Model（SAM）[15]进行自动标注。对于nuScenes提供边界框标注的物体类别，使用框提示生成高质量语义掩码；对于无边界框标注的背景类别（如路面、建筑），利用对应的点云语义分割标签，将属于这些类别的激光雷达点投影到图像上，每类随机选三个点作为点提示生成语义掩码，质量良好。借助2D图像语义掩码标签和深度真值图，我们联合训练深度估计和语义分割任务。此预训练任务与最终占据预测任务紧密相关，可直接利用深度值和语义标签生成3D占据结果，为后续占据预测任务提供更优初始模型。</p><h3 id="后处理" tabindex="-1"><a class="header-anchor" href="#后处理"><span>后处理</span></a></h3><h4 id="_2-3-1-测试时增强" tabindex="-1"><a class="header-anchor" href="#_2-3-1-测试时增强"><span>2.3.1 测试时增强</span></a></h4><p>测试时增强（TTA）中，输入图像水平翻转，3D空间在推理时水平和垂直翻转，共生成每帧八种预测结果，最终预测为所有结果的平均值。我们还观察到占据预测精度随距离显著下降，因此使用时序TTA缓解此问题：对于静态体素，利用靠近自车的前帧预测体素替换当前帧同位置体素。</p><h4 id="_2-3-2-集成" tabindex="-1"><a class="header-anchor" href="#_2-3-2-集成"><span>2.3.2 集成</span></a></h4><p>我们对所有独立结果进行加权求和，权重由两个乘积因子决定：一是与各结果整体mIoU相关的模型权重，二是与该体素类别IoU相关的特定类别权重。使用NNI[16]自动搜索不同权重值。</p><h2 id="_3-实验" tabindex="-1"><a class="header-anchor" href="#_3-实验"><span>3 实验</span></a></h2><h3 id="数据集与指标" tabindex="-1"><a class="header-anchor" href="#数据集与指标"><span>数据集与指标</span></a></h3><p><strong>数据集</strong>：占据数据集基于现有nuScenes数据集[13,17]构建。每帧提供[-40m,-40m,-1m,40m,40m,5.4m]范围内的占据标注，体素分辨率为0.4m。数据集含18类，其中一类表示未被占据的空体素，另提供相机掩码指示体素是否被任一相机可见。</p><p><strong>指标</strong>：挑战赛主要基于mIoU评估模型，公式如下：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mi>I</mi><mi>o</mi><mi>U</mi><mo>=</mo><mfrac><mn>1</mn><mi>C</mi></mfrac><munderover><mo>∑</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mfrac><mrow><mi>T</mi><msub><mi>P</mi><mi>c</mi></msub></mrow><mrow><mi>T</mi><msub><mi>P</mi><mi>c</mi></msub><mo>+</mo><mi>F</mi><msub><mi>P</mi><mi>c</mi></msub><mo>+</mo><mi>F</mi><msub><mi>N</mi><mi>c</mi></msub></mrow></mfrac><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">mIoU=\\frac{1}{C}\\sum_{c=1}^{C}\\frac{TP_{c}}{TP_{c}+FP_{c}+FN_{c}}, </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0954em;vertical-align:-1.2671em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><msub><mi>P</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">TP_{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 、 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><msub><mi>P</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">FP_{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 、 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><msub><mi>B</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">FB_{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 分别表示类别 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 的真阳性、假阳性和假阴性预测数， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> 为总类别数。</p><h3 id="实现细节" tabindex="-1"><a class="header-anchor" href="#实现细节"><span>实现细节</span></a></h3><p><strong>训练策略</strong>：训练大规模模型时，使用32块NVIDIA A100 GPU，批次大小32，AdamW优化器（学习率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">1×10^{-4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span> ，权重衰减0.05），主干学习率小10倍。占据任务训练约50轮，时序窗口根据GPU内存确定：Intern-H主干使用6帧，内存充足时最多用16帧。遵循SOLOFusion[18]，训练时使用在线时序序列以提升效率。</p><p><strong>网络细节</strong>：大规模模型中，主干图像特征下采样步长为16，输入图像尺寸640×1600。采用常用数据增强策略（翻转、图像和3D空间旋转）。深度网络预测80个离散深度类别（覆盖2m至42m），生成的3D体素特征分辨率为200×200×16。后向投影模块使用1层，因输入BEV查询已含语义先验。训练阶段忽略相机不可见体素。</p><h3 id="消融研究" tabindex="-1"><a class="header-anchor" href="#消融研究"><span>消融研究</span></a></h3><p>训练大规模模型需巨大计算资源。我们首先在小规模下验证不同模型效果：输入尺寸256×704，分辨率100×100×8，图像主干为ResNet-50[19]。探索里程碑如表1所示。版本A为基线；版本B使用BEVDepth的深度监督；版本C训练时忽略相机不可见体素；版本D修复了版本C的主要错误（尤其是“其他”类别异常IoU）；版本E利用前16帧时序信息；版本F采用联合深度-语义预训练；版本G通过添加Dice损失和3D变换对齐不同时间步体素特征优化损失函数；版本H为版本G的测试时增强结果。</p><h3 id="规模化" tabindex="-1"><a class="header-anchor" href="#规模化"><span>规模化</span></a></h3><p>确定FB-OCC基础设计后，通过更大主干和输入尺寸扩大模型规模，如表2所示。相比版本H，版本I使用VoVNet-99主干，输入尺寸960×1760，体素分辨率0.4m；版本J采用ViT-L主干和ViT-Adapter[20]；最强版本K使用InternImage-H主干，参数超10亿。</p><h3 id="后处理-1" tabindex="-1"><a class="header-anchor" href="#后处理-1"><span>后处理</span></a></h3><p>最终提交中，我们集成七个模型（主要区别为不同主干）以获取最佳精度，在测试集上达到54.19%的mIoU最高分。</p><h2 id="_4-结论" tabindex="-1"><a class="header-anchor" href="#_4-结论"><span>4 结论</span></a></h2><p>本报告描述了我们在CVPR 2023 3D占据预测挑战赛中的获胜方案。该方案展示了顶尖模型设计在BEV感知中的卓越表现，同时证明了视觉基础模型和大规模预训练在3D占据预测中的有效性。</p>',40)]))}const r=a(m,[["render",l]]),c=JSON.parse('{"path":"/%E6%84%9F%E7%9F%A5/l2r6j7r9/","title":"FBOCC","lang":"zh-CN","frontmatter":{"title":"FBOCC","createTime":"2025/04/27 14:43:15","permalink":"/感知/l2r6j7r9/"},"readingTime":{"minutes":9.46,"words":2839},"git":{"updatedTime":1750820984000,"contributors":[{"name":"weiwen","username":"","email":"a1036359215@163.com","commits":1,"avatar":"https://gravatar.com/avatar/cd8e1d2cae5eb43df4bdc241dd3c0611439067bff22550061317525e3b170bab?d=retro"}]},"filePathRelative":"notes/感知/occ/FBOCC.md","headers":[],"categoryList":[{"id":"4358b5","sort":10000,"name":"notes"},{"id":"fcfb7c","sort":10007,"name":"感知"},{"id":"44964a","sort":10014,"name":"occ"}]}');export{r as comp,c as data};
